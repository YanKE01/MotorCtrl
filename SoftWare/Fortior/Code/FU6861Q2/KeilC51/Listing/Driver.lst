C51 COMPILER V9.52.0.0   DRIVER                                                            04/01/2023 22:13:44 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE DRIVER
OBJECT MODULE PLACED IN .\Output\Driver.obj
COMPILER INVOKED BY: D:\IDE\keil\C51\BIN\C51.EXE ..\User\Source\Hardware\Driver.c LARGE OMF2 WARNINGLEVEL(0) BROWSE INCD
                    -IR(..\User\Include;..\FU68xx_Hardware_Driver\Include) DEBUG PRINT(.\Listing\Driver.lst) TABS(2) OBJECT(.\Output\Driver.o
                    -bj)

line level    source

   1          /**
   2           * @copyright (C) COPYRIGHT 2022 Fortiortech Shenzhen
   3           * @file      CMPInit.c
   4           * @author    Fortiortech  Appliction Team
   5           * @since     Create:2021-05-14
   6           * @date      Last modify:2022-07-14
   7           * @brief     This file contains driver initial function used for Motor Control.
   8           */ 
   9           
  10          #include <FU68xx_2.h>
  11          #include <Myproject.h>
  12          
  13          /**
  14           * @brief      DriverÂàùÂßãÂåñÈÖçÁΩÆ
  15           */
  16          void Driver_Init(void)
  17          {
  18   1          /* -----ÈÖçÁΩÆPWMÂë®ÊúüÂÄºÂíåÊ≠ªÂå∫Êó∂Èó¥----- */
  19   1          DRV_ARR             = PWM_VALUE_LOAD;                                           // ËΩΩÊ≥¢È¢ëÁéáÁöÑÂë®Ê
             -úüÂÄº
  20   1          DRV_DTR             = PWM_LOAD_DEADTIME;                                        // Ê≠ªÂå∫Êó∂Èó¥
  21   1          /*  -------------------------------------------------------------------------------------------------
  22   1              1„ÄÅÈÖçÁΩÆMEÊ®°ÂùóÂ∑•‰ΩúÊ®°Âºè
  23   1              2„ÄÅMESEL‰∏∫0ÔºåMEÊ®°ÂùóÂ∑•‰ΩúÂú®BLDCÊ®°Âºè
  24   1              3„ÄÅMESEL‰∏∫1ÔºåMEÊ®°ÂùóÂ∑•‰ΩúÂú®FOC/SVPWM/SPWMÊ®°Âºè
  25   1              -------------------------------------------------------------------------------------------------*
             -/
  26   1          SetBit(DRV_CR, MESEL);
  27   1          /* -----È©±Âä®ÊúâÊïàÁîµÂπ≥ÂíåÁ©∫Èó≤ÁîµÂπ≥----- */
  28   1          #if (PWM_Level_Mode == High_Level)
                  {
                      DRV_CMR &= 0x003f;
                      DRV_OUT &= 0xC0;
                  }
                  #elif (PWM_Level_Mode == Low_Level)
                  {
                      DRV_CMR |= 0x0fc0;
                      DRV_OUT = 0x3F;
                  }
                  #elif (PWM_Level_Mode == UP_H_DOWN_L)
  39   1          {
  40   2              DRV_CMR = 0x0540;
  41   2              DRV_OUT = 0x2A;
  42   2          }
  43   1          #elif (PWM_Level_Mode == UP_L_DOWN_H)
                  {
                      DRV_CMR &= 0x0a80;
                      DRV_OUT = 0x15;
                  }
                  #endif //end PWM_Level_Mode
  49   1          /* -----Ê∏Ö‰∏≠Êñ≠Ê†áÂøó‰ΩçÔºå‰ΩøËÉΩ‰∏≠Êñ≠ÔºåÈÖçÁΩÆÊØîËæÉÂÄºÔºåËÆæÁΩÆ‰∏≠Êñ≠‰ºòÂÖàÁ∫ß----- */
  50   1          ClrBit(DRV_SR, DCIF);                                                           // Ê∏ÖÈô§DRV‰∏≠Êñ≠Ê†áÂ
             -øó‰Ωç
C51 COMPILER V9.52.0.0   DRIVER                                                            04/01/2023 22:13:44 PAGE 2   

  51   1          /*  -------------------------------------------------------------------------------------------------
  52   1              1„ÄÅÈÖçÁΩÆDRVÊØîËæÉÂåπÈÖç‰∏≠Êñ≠Ê®°Âºè
  53   1              2„ÄÅÂΩìËÆ°Êï∞ÂÄºÁ≠â‰∫éDRV_COMRÊó∂ÔºåÊ†πÊçÆDCIMÁöÑËÆæÁΩÆÂà§Êñ≠ÊòØÂê¶‰∫ßÁîü‰∏≠Êñ≠Ê†áËÆ∞
  54   1              3„ÄÅ00Ôºö‰∏ç‰∫ßÁîü‰∏≠Êñ≠
  55   1              4„ÄÅ01Ôºö‰∏äÂçáÊñπÂêë
  56   1              5„ÄÅ10Ôºö‰∏ãÈôçÊñπÂêë
  57   1              6„ÄÅ11Ôºö‰∏ä‰∏ãÊ≤ø
  58   1              -------------------------------------------------------------------------------------------------*
             -/
  59   1          SetReg(DRV_SR, DCIM0 | DCIM1, DCIM1);
  60   1          /* -----ËÆæÁΩÆDRVËÆ°Êï∞Âô®ÁöÑÊØîËæÉÂåπÈÖçÂÄºÔºåÂΩìDRVËÆ°Êï∞ÂÄº‰∏éCOMRÁõ∏Á≠âÊó∂ÔºåÊ†πÊçÆDRV_SRÂØÑÂ≠òÂô®
             -ÁöÑDCIMÊòØÂê¶‰∫ßÁîüÊØîËæÉÂåπÈÖç‰∫ã‰ª∂----- */
  61   1          DRV_COMR = (PWM_VALUE_LOAD >> 1);
  62   1          /* -----‰∏≠Êñ≠‰ºòÂÖàÁ∫ßÈÖçÁΩÆÔºå‰ºòÂÖàÁ∫ß‰Ωé‰∫éFOÁ°¨‰ª∂ËøáÊµÅ----- */
  63   1          PDRV1 = 1;
  64   1          PDRV0 = 1;
  65   1          /* -----ÈÖçÁΩÆ1‰∏™/2‰∏™ËΩΩÊ≥¢Âë®ÊúüÊâßË°å‰∏ÄÊ¨°FOCÁªàÁ´ØÔºå0--1‰∏™Ôºå1-2‰∏™----- */
  66   1          SetBit(DRV_SR, DCIP);
  67   1          /* -----DRVËÆ°Êï∞Âô®‰ΩøËÉΩÔºå0-Á¶ÅÊ≠¢Ôºå1-‰ΩøËÉΩ----- */
  68   1          SetBit(DRV_CR, DRVEN);
  69   1          /* -----DRVËÆ°Êï∞Âô®ÊØîËæÉÂÄºÈ¢ÑË£ÖËΩΩ‰ΩøËÉΩÔºå0-Á¶ÅÊ≠¢Ôºå1-‰ΩøËÉΩ----- */
  70   1          ClrBit(DRV_CR, DRPE);
  71   1          /* -----Driver ËæìÂá∫‰ΩøËÉΩÔºå0-Á¶ÅÊ≠¢Ôºå1-‰ΩøËÉΩ----- */
  72   1          SetBit(DRV_CR, DRVOE);
  73   1      }
  74          
  75          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     81    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
