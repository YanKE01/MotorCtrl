C51 COMPILER V9.52.0.0   MDU                                                               04/01/2023 22:13:44 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MDU
OBJECT MODULE PLACED IN .\Output\MDU.obj
COMPILER INVOKED BY: D:\IDE\keil\C51\BIN\C51.EXE ..\User\Source\Hardware\MDU.c LARGE OMF2 WARNINGLEVEL(0) BROWSE INCDIR(
                    -..\User\Include;..\FU68xx_Hardware_Driver\Include) DEBUG PRINT(.\Listing\MDU.lst) TABS(2) OBJECT(.\Output\MDU.obj)

line level    source

   1          /**
   2           * @copyright (C) COPYRIGHT 2022 Fortiortech Shenzhen
   3           * @file      MDUInit.c
   4           * @author    Fortiortech  Appliction Team
   5           * @since     Create:2021-05-14
   6           * @date      Last modify:2022-07-14
   7           * @brief     This file contains MDU initial function used for Motor Control.
   8           */    
   9              
  10          #include <FU68xx_2.h>
  11          #include <Myproject.h>
  12          
  13          /** 
  14           * @brief        1ã€32ä½æ— ç¬¦å·é™¤æ³•ï¼Œè¿”å›32ä½æ— ç¬¦å·å€¼
  15                           2ã€è¿è¡Œæ—¶é—´9.3us
  16                           3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
  17                           4ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºXDATA
  18                           5ã€TData0(32ä½)/TData1(16ä½) = RData32(32ä½)
  19           * @param[in]    TData0 è¢«é™¤æ•°(32ä½) 
  20           * @param[in]    TData1 é™¤æ•°(16ä½)
  21           * @return       32ä½å•†
  22           */
  23           uint32 MDU_DIV_XDATA_U32(uint8 xdata * TData0, uint8 xdata * TData1)
  24          {
  25   1          uint32 RData32;
  26   1          uint16 * PData16;
  27   1          
  28   1          DIV0_DAH = ((*(TData0+0))<<8)+(*(TData0+1));
  29   1          DIV0_DAL = ((*(TData0+2))<<8)+(*(TData0+3));
  30   1          
  31   1          DIV0_DB = ((*(TData1+0))<<8)+(*(TData1+1));
  32   1          
  33   1          SMDU_RunBlock(0, DIV)
  34   1          
  35   1          PData16 = &RData32;
  36   1          *PData16 = DIV0_DQH;
  37   1          PData16 += 1;
  38   1          *PData16 = DIV0_DQL;
  39   1          return RData32;
  40   1      }
  41          
  42          
  43          /*  -------------------------------------------------------------------------------------------------
  44              Function Name  : MDU_DIV_XDATA_U16
  45              Description    : 1ã€16ä½æ— ç¬¦å·é™¤æ³•ï¼Œè¿”å›16ä½æ— ç¬¦å·å€¼
  46                               2ã€è¿è¡Œæ—¶é—´5.6us
  47                               3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
  48                               4ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºXDATA
  49              Date           : 2020-08-07
  50              Parameter      : TData0 : [è¾“å…¥] -- è¢«é™¤æ•°(16ä½)    TData1: [è¾“å…¥] -- é™¤æ•°(16ä½)
  51          **                   RData32: [è¾“å‡º] -- 16ä½å•†
  52              ------------------------------------------------------------------------------------------------- */
  53          //uint16 MDU_DIV_XDATA_U16(uint8 xdata * TData0, uint8 xdata * TData1)
  54          //{
C51 COMPILER V9.52.0.0   MDU                                                               04/01/2023 22:13:44 PAGE 2   

  55          //    uint16 RData16;
  56          //    uint16 * PData16;
  57          //    MDU_DA3 = 0x00;
  58          //    MDU_DA2 = 0x00;
  59          //    MDU_DA1 = *(TData0 + 0);
  60          //    MDU_DA0 = *(TData0 + 1);
  61          //    MDU_DB1 = *(TData1 + 0);
  62          //    MDU_DB0 = *(TData1 + 1);
  63          //    SetBit(MDU_CR, DIVSTA);
  64          //    
  65          //    while (!ReadBit(MDU_CR, DIVDONE));                           // ç­‰å¾…MDUè®¡ç®—å®Œæˆ
  66          //    
  67          //    PData16 = &RData16;
  68          //    *PData16 = MDU_DA01;
  69          //    return MDU_DA01;
  70          //}
  71          
  72          /** 
  73           * @brief        1ã€32ä½æ— ç¬¦å·é™¤æ³•ï¼Œè¿”å›32ä½æ— ç¬¦å·å€¼
  74                           2ã€è¿è¡Œæ—¶é—´9.3us
  75                           3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
  76                           4ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºIDATA
  77                           5ã€TData0(32ä½)/TData1(16ä½) = RData32(32ä½)
  78           * @param[in]    TData0 è¢«é™¤æ•°(32ä½) 
  79           * @param[in]    TData1 é™¤æ•°(16ä½)
  80           * @return       32ä½å•†
  81           */
  82          uint32 MDU_DIV_IDATA_U32(uint8 idata * TData0, uint8 idata * TData1)
  83          {
  84   1          uint32 RData32;
  85   1          uint16 * PData16;
  86   1          DIV0_DAH = ((*(TData0+0))<<8)+(*(TData0+1));
  87   1          DIV0_DAL = ((*(TData0+2))<<8)+(*(TData0+3));
  88   1          
  89   1          DIV0_DB = ((*(TData1+0))<<8)+(*(TData1+1));
  90   1          
  91   1          SMDU_RunBlock(0, DIV)
  92   1          
  93   1          PData16 = &RData32;
  94   1          *PData16 = DIV0_DQH;
  95   1          PData16 += 1;
  96   1          *PData16 = DIV0_DQL;
  97   1          return RData32;
  98   1      }
  99          
 100          /*  -------------------------------------------------------------------------------------------------
 101              Function Name  : MDU_DIV_IDATA_U16
 102              Description    : 1ã€16ä½æ— ç¬¦å·é™¤æ³•ï¼Œè¿”å›16ä½æ— ç¬¦å·å€¼
 103                               2ã€è¿è¡Œæ—¶é—´4.6us
 104                               3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
 105                               4ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºIDATA
 106              Date           : 2020-08-07
 107              Parameter      : TData0 : [è¾“å…¥] -- è¢«é™¤æ•°(16ä½)    TData1: [è¾“å…¥] -- é™¤æ•°(16ä½)
 108          **                   RData32: [è¾“å‡º] -- 16ä½å•†
 109              ------------------------------------------------------------------------------------------------- */
 110          
 111          //uint16 MDU_DIV_IDATA_U16(uint8 idata * TData0, uint8 idata * TData1)
 112          //{
 113          //    uint16 RData16;
 114          //    uint16 * PData16;
 115          //    MDU_DA3 = 0x00;
 116          //    MDU_DA2 = 0x00;
C51 COMPILER V9.52.0.0   MDU                                                               04/01/2023 22:13:44 PAGE 3   

 117          //    MDU_DA1 = *(TData0 + 0);
 118          //    MDU_DA0 = *(TData0 + 1);
 119          //    MDU_DB1 = *(TData1 + 0);
 120          //    MDU_DB0 = *(TData1 + 1);
 121          //    SetBit(MDU_CR, DIVSTA);
 122          //    
 123          //    while (!ReadBit(MDU_CR, DIVDONE));                          // ç­‰å¾…MDUè®¡ç®—å®Œæˆ
 124          //    
 125          //    PData16 = &RData16;
 126          //    *PData16 = MDU_DA01;
 127          //    return MDU_DA01;
 128          //}
 129          
 130          /*  -------------------------------------------------------------------------------------------------
 131              Function Name  : MDU_16MUL16_INT
 132              Description    : æœ‰æ— ç¬¦å·ä¹˜æ³•é€‰ï¼Œç»“æœå³ç§»ALIGNä½
 133              Date           : 2020-08-07
 134              Parameter      : ALIGN: [è¾“å…¥]
 135          **                   SIGN : [è¾“å…¥]
 136              ------------------------------------------------------------------------------------------------- */
 137          //void MDU_16MUL16_INT(uint8 ALIGN, uint8 SIGN)
 138          //{
 139          //    if (ALIGN == 0)
 140          //    {
 141          //        MDU_CR &= ~(1 << ALIGN1);
 142          //        MDU_CR &= ~(1 << ALIGN0);                               // 00:ä¹˜æ³•ç»“æœå³ç§»0ä½
 143          //    }
 144          //    else if (ALIGN == 8)
 145          //    {
 146          //        MDU_CR &= ~(1 << ALIGN1);
 147          //        MDU_CR |= (1 << ALIGN0);                                // 01:ä¹˜æ³•ç»“æœå³ç§»8ä½
 148          //    }
 149          //    else if (ALIGN == 12)
 150          //    {
 151          //        MDU_CR |= (1 << ALIGN1);
 152          //        MDU_CR &= ~(1 << ALIGN0);                               // 10:ä¹˜æ³•ç»“æœå³ç§»12ä½
 153          //    }
 154          //    else if (ALIGN == 15)
 155          //    {
 156          //        MDU_CR |= (1 << ALIGN1);
 157          //        MDU_CR |= (1 << ALIGN0);                                // 11:ä¹˜æ³•ç»“æœå³ç§»15ä½
 158          //    }
 159          //    else ;
 160          //    
 161          //    if (SIGN == 0)
 162          //    {
 163          //        MDU_CR &= ~(1 << MDSN);                                 // é€‰æ‹©æ— ç¬¦å·ä¹˜æ³•
 164          //    }
 165          //    else if (SIGN == 1)
 166          //    {
 167          //        MDU_CR |= (1 << MDSN);                                  // é€‰æ‹©æœ‰ç¬¦å·ä¹˜æ³•
 168          //    }
 169          //    else ;
 170          //}
 171          
 172          /** 
 173           * @brief        1ã€32ä½æ— ç¬¦å·ä¹˜æ³•ï¼Œè¿”å›32ä½æ— ç¬¦å·å€¼
 174                           2ã€è¿è¡Œæ—¶é—´3.0-3.8us
 175                           3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
 176                           4ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºXDATA
 177           * @param[in]    TData0 ä¹˜æ•°0(16ä½) 
 178           * @param[in]    TData1 ä¹˜æ•°1(16ä½)
C51 COMPILER V9.52.0.0   MDU                                                               04/01/2023 22:13:44 PAGE 4   

 179           * @param[out]   Result32_t 32ä½ä¹˜ç§¯å˜é‡æŒ‡é’ˆ
 180           */
 181          void MDU_MUL_XDATA_U32(uint16 TData0, uint16 TData1, uint16 xdata * Result32_t)
 182          {
 183   1      
 184   1          MUL0_MA = TData0;
 185   1          MUL0_MB = TData1;                                            // å†™è¢«ä¹˜æ•°å’Œä¹˜æ•°
 186   1          SMDU_RunBlock(0, UMUL)
 187   1          *Result32_t = MUL0_MCH;
 188   1          *(Result32_t + 1) = MUL0_MCL;
 189   1      }
 190          
 191          /*  -------------------------------------------------------------------------------------------------
 192              Function Name  : MDU_MUL_XDATA_RIGHT_U32
 193              Description    : 1ã€16ä½æ— ç¬¦å·ä¹˜æ³•ï¼Œè¿”å›32ä½æ— ç¬¦å·å€¼
 194                               2ã€è¿è¡Œæ—¶é—´3.0-3.8us
 195                               3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
 196                               4ã€ç»“æœå³ç§»ALIGNä½
 197                               5ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºXDATA
 198              Date           : 2020-08-07
 199              Parameter      : TData0 : [è¾“å…¥] -- ä¹˜æ•°0(16ä½)            TData1: [è¾“å…¥] -- ä¹˜æ•°1(16ä½)
 200          **                   RData32: [è¾“å‡º] -- 32ä½ä¹˜ç§¯å˜é‡æŒ‡é’ˆ       ALIGN ï¼š[è¾“å…¥] -- ä¹˜ç§¯å³ç§»ä
             -½æ•°
 201              ------------------------------------------------------------------------------------------------- */
 202          //void MDU_MUL_XDATA_RIGHT_U32(uint16 TData0, uint16 TData1, uint8 ALIGN, uint16 xdata * Result32_t)
 203          //{
 204          //    if (ALIGN == 8)
 205          //    {
 206          //        SetBit(MDU_CR, ALIGN0);
 207          //        ClrBit(MDU_CR, ALIGN1);                                 // 01:ä¹˜æ³•ç»“æœå³ç§»8ä½
 208          //    }
 209          //    else if (ALIGN == 12)
 210          //    {
 211          //        SetBit(MDU_CR, ALIGN1);                                 // 10:ä¹˜æ³•ç»“æœå³ç§»12ä½
 212          //        ClrBit(MDU_CR, ALIGN0);
 213          //    }
 214          //    else if (ALIGN == 15)
 215          //    {
 216          //        SetBit(MDU_CR, ALIGN1 | ALIGN0);                        // 11:ä¹˜æ³•ç»“æœå³ç§»15ä½
 217          //    }
 218          //    else
 219          //    {
 220          //        ClrBit(MDU_CR, ALIGN1 | ALIGN0);                        // 00:ä¹˜æ³•ç»“æœä¸å³ç§»
 221          //    }
 222          //    
 223          //    ClrBit(MDU_CR, MDSN);                                       // 0-æ— ç¬¦å·ä¹˜æ³•ï¼Œ1-æœ‰ç¬¦å·ä¹˜æ³•
 224          //    MDU_MA = TData0;
 225          //    MDU_MB = TData1;                                            // å†™è¢«ä¹˜æ•°å’Œä¹˜æ•°
 226          //    *(Result32_t) = MDU_MA;
 227          //    *(Result32_t + 1) = MDU_MB;
 228          //}
 229          
 230          /*  -------------------------------------------------------------------------------------------------
 231              Function Name  : MDU_MUL_XDATA_U16
 232              Description    : 1ã€16ä½æ— ç¬¦å·ä¹˜æ³•ï¼Œè¿”å›16ä½æ— ç¬¦å·å€¼
 233                               2ã€è¿è¡Œæ—¶é—´3.0-3.8us
 234                               3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
 235                               4ã€ç»“æœå³ç§»ALIGNä½
 236                               5ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºXDATA
 237              Date           : 2020-08-07
 238              Parameter      : TData0 : [è¾“å…¥] -- ä¹˜æ•°0(16ä½)            TData1: [è¾“å…¥] -- ä¹˜æ•°1(16ä½)
 239          **                   RData32: [è¾“å‡º] -- 16ä½ä¹˜ç§¯å˜é‡æŒ‡é’ˆ
C51 COMPILER V9.52.0.0   MDU                                                               04/01/2023 22:13:44 PAGE 5   

 240              ------------------------------------------------------------------------------------------------- */
 241          //void MDU_MUL_XDATA_U16(uint16 TData0, uint16 TData1, uint16 xdata * Result16_t)
 242          //{
 243          //    ClrBit(MDU_CR, ALIGN1 | ALIGN0);                            // 00:ä¹˜æ³•ç»“æœå³ç§»0ä½
 244          //    ClrBit(MDU_CR, MDSN);                                       // 0-æ— ç¬¦å·ä¹˜æ³•ï¼Œ1-æœ‰ç¬¦å·ä¹˜æ³•
 245          //    MDU_MA = TData0;
 246          //    MDU_MB = TData1;                                            // å†™è¢«ä¹˜æ•°å’Œä¹˜æ•°
 247          //    *(Result16_t) = MDU_MB;
 248          //}
 249          
 250          /** 
 251           * @brief        1ã€32ä½æ— ç¬¦å·ä¹˜æ³•ï¼Œè¿”å›32ä½æ— ç¬¦å·å€¼
 252                           2ã€è¿è¡Œæ—¶é—´3.0-3.8us
 253                           3ã€å‡½æ•°åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¦‚æœè¢«ä¸­æ–­æ‰“æ–­åˆ™ä¼šé‡å¤è°ƒç”¨
 254                           4ã€åº”ç”¨äºæ•°æ®ç±»å‹ä¸ºIDATA
 255           * @param[in]    TData0 ä¹˜æ•°0(16ä½) 
 256           * @param[in]    TData1 ä¹˜æ•°1(16ä½)
 257           * @param[out]   Result32_t 32ä½ä¹˜ç§¯å˜é‡æŒ‡é’ˆ
 258           */
 259          
 260          void MDU_MUL_IDATA_U32(uint16 TData0, uint16 TData1, uint16 idata * Result32_t)
 261          {
 262   1          MUL0_MA = TData0;
 263   1          MUL0_MB = TData1;                                            // å†™è¢«ä¹˜æ•°å’Œä¹˜æ•°
 264   1          SMDU_RunBlock(0, UMUL)
 265   1          *Result32_t = MUL0_MCH;
 266   1          *(Result32_t + 1) = MUL0_MCL;
 267   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    392    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      10
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
