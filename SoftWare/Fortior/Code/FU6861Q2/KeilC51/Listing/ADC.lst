C51 COMPILER V9.52.0.0   ADC                                                               04/01/2023 22:13:43 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE ADC
OBJECT MODULE PLACED IN .\Output\ADC.obj
COMPILER INVOKED BY: D:\IDE\keil\C51\BIN\C51.EXE ..\User\Source\Hardware\ADC.c LARGE OMF2 WARNINGLEVEL(0) BROWSE INCDIR(
                    -..\User\Include;..\FU68xx_Hardware_Driver\Include) DEBUG PRINT(.\Listing\ADC.lst) TABS(2) OBJECT(.\Output\ADC.obj)

line level    source

   1          /**
   2           * @copyright (C) COPYRIGHT 2022 Fortiortech Shenzhen
   3           * @file      ADCInit.c
   4           * @author    Fortiortech  Appliction Team
   5           * @since     Create:2021-05-14
   6           * @date      Last modify:2022-07-14
   7           * @brief     This file contains ADC function function used for Motor Control
   8           */   
   9          #include <FU68xx_2.h>
  10          #include <Myproject.h>
  11          #include <FU68xx_2_System.h>
  12          
  13          /**
  14           * @brief      ADC硬件设备初始化配置，使能ADC，通道配置，采样时间配置，中断配
             -
  15           */
  16          void ADC_Init(void)
  17          {
  18   1          uint16 ADCVREF_DelayCnt;
  19   1          /* -----ADC参考电压配置----- */
  20   1          VREFConfig(Enable);                                                             // ADC参考电压配
             -
  21   1          SetBit(P3_AN, P35);                                                             //送出给P3.5的VREF
             -电压，P3.5需外接电容
  22   1          /*  -------------------------------------------------------------------------------------------------
  23   1              ADC基本配置
  24   1              -------------------------------------------------------------------------------------------------*
             -/
  25   1          SetBit(ADC_CR, ADCEN);                                                          // 使能ADC
  26   1          /*  -------------------------------------------------------------------------------------------------
  27   1              1、ADC参考电压选择
  28   1              2、使能VREF，用于给ADC提供内部参考基准
  29   1              3、P3.5配置模拟IO，VREFEN为1-内部参考电压提供给ADC，同时送出给P3.5的VREF电
             -压;
  30   1              4、P3.5配置模拟IO，VREFEN为0-外部参考电压提供给ADC，需外部提供ADC参考。
  31   1              -------------------------------------------------------------------------------------------------*
             -/
  32   1          SetBit(VREF_VHALF_CR, VREFEN);                                                  //使能VREF
  33   1          
  34   1          for (ADCVREF_DelayCnt = 0; ADCVREF_DelayCnt < 2000; ADCVREF_DelayCnt++) {};     //等待VREF稳定
  35   1          
  36   1          /*  -------------------------------------------------------------------------------------------------
  37   1              1、ADC通道配置
  38   1              2、使能相应Pin为模拟Pin，禁止数字功能
  39   1              3、使能通道MASK，连接Pin到ADC模块
  40   1              4、ADC_CH0--P20_AN--IU--固定                 ADC_CH5--P32_AN
  41   1              5、ADC_CH1--P23_AN--IV--固定                 ADC_CH6--P33_AN
  42   1              6、ADC_CH2--P24_AN--DCBUS--固定              ADC_CH7--P34_AN
  43   1              7、ADC_CH3--P25_AN--VSP                      ADC_CH8--P21_AN
  44   1              8、ADC_CH4--P27_AN--IBUS/IW--固定            ADC_CH9--P16_AN
  45   1                                                       ADC_CH10--P14_AN
  46   1                                                       ADC_CH11--P15_AN
  47   1              -------------------------------------------------------------------------------------------------*
             -/
C51 COMPILER V9.52.0.0   ADC                                                               04/01/2023 22:13:43 PAGE 2   

  48   1          SetBit(P3_AN,  P34);                                                            
  49   1          
  50   1          SetBit(P2_AN, P27 | P25 | P24 | P23 | P20);
  51   1          
  52   1          SetBit(ADC_MASK_SYSC, CH7EN | CH6EN | CH4EN | CH3EN | CH2EN | CH1EN | CH0EN);    // 使能AD
  53   1          
  54   1          /* -----ADC通道采样时钟周期设置----- */
  55   1          SetBit(ADC_MASK_SYSC, 0x3000);
  56   1          
  57   1          ADC_SYSC  = 0x33;
  58   1          
  59   1          SetReg(ADC_CR, ADCIF | ADCIE, 0x00);                                            // 清标志位和关
             -断
  60   1      }
  61          
  62          
  63          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    110    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
